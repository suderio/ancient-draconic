# Task: Architecture Pivot to Data-Driven Game Engine

- [x] Phase 1: Infrastructure & Environment Setup
  - [x] Add `google/cel-go` dependency
  - [x] Create `internal/rules` package for CEL initialization
  - [x] Implement `roll()` custom function for CEL
- [x] Phase 2: Core Data Model Refactor
  - [x] Update `engine.Entity` to generic map-based stats
  - [x] Implement `Ability` and `Action` models with CEL support
  - [x] Refactor `data.Loader` to populate generic structs
- [x] Phase 3: Rule Evaluation Bridge
  - [x] Implement `EvalRule` in the engine
  - [x] Create context binding for CEL (actor, target, action)
  - [x] Refactor `attack` command to use CEL formulas
  - [x] Refactor `check` command to use CEL formulas
- [x] Phase 4: System Manifest & Extensibility
  - [x] Implement `CampaignManifest` (global rules/formulas)
  - [x] Dynamic command registration in the manifest
  - [x] Generic Command Executor (`ExecuteGenericCommand`)
  - [x] Unified mapping logic for complex events (Attack/Check)
  - [x] Automated Help action consumption via CEL
- [x] Phase 5: Cleanup & Verification
  - [x] Remove hard-coded D&D logic (`attack.go`, `check.go`)
  - [x] Update and verify full integration test suite
  - [x] Final architecture walkthrough
